<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">German Basics - Misiro</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
        }

        .category-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        .category-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: #fff;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }

        .header-title {
            flex: 1;
        }

        .header-title h1 {
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-title h1 .icon {
            font-size: 2.5rem;
        }

        .header-title p {
            color: #a0a0a0;
            margin-top: 5px;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .controls select {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .controls select option {
            background: #1a1a2e;
        }

        /* Word Grid */
        .word-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .word-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .word-card:hover {
            transform: translateY(-5px);
            background: rgba(46, 204, 113, 0.2);
            border-color: #2ecc71;
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.25);
        }

        .word-card:active {
            transform: scale(0.95);
        }

        .word-german {
            font-size: clamp(1rem, 4vw, 1.6rem);
            font-weight: 700;
            margin-bottom: 10px;
            color: #2ecc71;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            line-height: 1.2;
        }

        .word-translation {
            font-size: 1rem;
            color: #ccc;
            margin-bottom: 8px;
        }

        .word-example {
            font-size: 0.85rem;
            color: #888;
            font-style: italic;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: color 0.3s;
        }

        .word-example:hover {
            color: #2ecc71;
        }

        .example-speaker {
            opacity: 0.6;
            transition: opacity 0.3s;
        }

        .word-example:hover .example-speaker {
            opacity: 1;
        }

        .play-icon {
            font-size: 1.3rem;
            opacity: 0.5;
            margin-top: 10px;
            transition: opacity 0.3s;
        }

        .word-card:hover .play-icon {
            opacity: 1;
        }

        /* Pronoun Table (special layout) */
        .pronoun-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .pronoun-row {
            display: grid;
            grid-template-columns: 100px 1fr 2fr;
            gap: 15px;
            padding: 18px 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            align-items: center;
        }

        .pronoun-row:hover {
            background: rgba(46, 204, 113, 0.15);
            transform: translateX(5px);
        }

        .pronoun-german {
            font-weight: 700;
            color: #2ecc71;
            font-size: 1.4rem;
        }

        .pronoun-meaning {
            color: #3498db;
            font-size: 1.1rem;
        }

        .pronoun-example {
            color: #888;
            font-size: 0.95rem;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .category-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-title h1 {
                font-size: 1.5rem;
            }

            .word-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .pronoun-row {
                grid-template-columns: 80px 1fr;
            }

            .pronoun-example {
                grid-column: span 2;
            }
        }
    </style>
</head>

<body>
    <div class="category-container">
        <!-- Header -->
        <header class="category-header">
            <a href="../basics.html" class="back-btn">‚Üê <span id="back-text">Back</span></a>
            <div class="header-title">
                <h1>
                    <span class="icon" id="cat-icon">üìö</span>
                    <span id="cat-title">Loading...</span>
                </h1>
                <p id="cat-description">Loading content...</p>
            </div>
            <div class="controls">
                <select id="language-select">
                    <option value="fa">üáÆüá∑ ŸÅÿßÿ±ÿ≥€å</option>
                    <option value="en">üá¨üáß English</option>
                </select>
                <select id="speed-select">
                    <option value="1">üîä 1x</option>
                    <option value="0.75">üîâ 0.75x</option>
                    <option value="0.5">üê¢ 0.5x</option>
                    <option value="0.25">üêå 0.25x</option>
                </select>
            </div>
        </header>

        <!-- Content Container -->
        <div id="content-container">
            <!-- Words will be rendered here -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="../config.js"></script>
    <script src="../supabase-client.js"></script>
    <script src="../data-layer.js"></script>
    <script>
        // =====================
        // VOCABULARY DATA
        // =====================
        const categoryData = {
            pronouns: {
                icon: "üë§",
                title: { en: "Personal Pronouns", fa: "ÿ∂ŸÖÿß€åÿ± ÿ¥ÿÆÿµ€å" },
                description: { en: "Master the German personal pronouns", fa: "ÿ∂ŸÖÿß€åÿ± ÿ¥ÿÆÿµ€å ÿ¢ŸÑŸÖÿßŸÜ€å ÿ±ÿß €åÿßÿØ ÿ®⁄Ø€åÿ±€åÿØ" },
                type: "table",
                words: [
                    { german: "ich", en: "I", fa: "ŸÖŸÜ", example: "Ich bin hier." },
                    { german: "du", en: "you (informal)", fa: "ÿ™Ÿà", example: "Du bist nett." },
                    { german: "er", en: "he", fa: "ÿßŸà (ŸÖÿ∞⁄©ÿ±)", example: "Er ist gro√ü." },
                    { german: "sie", en: "she", fa: "ÿßŸà (ŸÖÿ§ŸÜÿ´)", example: "Sie ist sch√∂n." },
                    { german: "es", en: "it", fa: "ÿ¢ŸÜ", example: "Es ist kalt." },
                    { german: "wir", en: "we", fa: "ŸÖÿß", example: "Wir sind Freunde." },
                    { german: "ihr", en: "you (plural)", fa: "ÿ¥ŸÖÿß (ÿ¨ŸÖÿπ)", example: "Ihr seid toll." },
                    { german: "sie", en: "they", fa: "ÿ¢ŸÜŸáÿß", example: "Sie sind hier." },
                    { german: "Sie", en: "you (formal)", fa: "ÿ¥ŸÖÿß (ÿ±ÿ≥ŸÖ€å)", example: "Sind Sie Herr M√ºller?" }
                ]
            },
            articles: {
                icon: "üìù",
                title: { en: "Articles", fa: "ÿ≠ÿ±ŸàŸÅ ÿ™ÿπÿ±€åŸÅ" },
                description: { en: "German has 3 genders - learn the articles!", fa: "ÿ¢ŸÑŸÖÿßŸÜ€å €≥ ÿ¨ŸÜÿ≥€åÿ™ ÿØÿßÿ±ÿØ - ÿ≠ÿ±ŸàŸÅ ÿ™ÿπÿ±€åŸÅ ÿ±ÿß €åÿßÿØ ÿ®⁄Ø€åÿ±€åÿØ!" },
                type: "grid",
                words: [
                    { german: "der", en: "the (masculine)", fa: "ÿß€åŸÜ (ŸÖÿ∞⁄©ÿ±)", example: "der Mann - the man" },
                    { german: "die", en: "the (feminine)", fa: "ÿß€åŸÜ (ŸÖÿ§ŸÜÿ´)", example: "die Frau - the woman" },
                    { german: "das", en: "the (neuter)", fa: "ÿß€åŸÜ (ÿÆŸÜÿ´€å)", example: "das Kind - the child" },
                    { german: "ein", en: "a/an (masc/neut)", fa: "€å⁄© (ŸÖÿ∞⁄©ÿ±/ÿÆŸÜÿ´€å)", example: "ein Buch - a book" },
                    { german: "eine", en: "a/an (feminine)", fa: "€å⁄© (ŸÖÿ§ŸÜÿ´)", example: "eine Blume - a flower" }
                ]
            },
            conjunctions: {
                icon: "üîó",
                title: { en: "Conjunctions", fa: "ÿ≠ÿ±ŸàŸÅ ÿ±ÿ®ÿ∑" },
                description: { en: "Connect words, phrases, and clauses", fa: "⁄©ŸÑŸÖÿßÿ™ÿå ÿπÿ®ÿßÿ±ÿßÿ™ Ÿà ÿ¨ŸÖŸÑÿßÿ™ ÿ±ÿß ÿ®Ÿá ŸáŸÖ ŸàÿµŸÑ ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ" },
                type: "grid",
                words: [
                    { german: "und", en: "and", fa: "Ÿà", example: "Ich und du - me and you" },
                    { german: "oder", en: "or", fa: "€åÿß", example: "Ja oder nein? - Yes or no?" },
                    { german: "aber", en: "but", fa: "ÿßŸÖÿß", example: "Klein, aber fein - Small but fine" },
                    { german: "denn", en: "because/for", fa: "ÿ≤€åÿ±ÿß", example: "Ich bleibe, denn es regnet - I stay because it's raining" },
                    { german: "sondern", en: "but rather", fa: "ÿ®ŸÑ⁄©Ÿá", example: "Nicht ich, sondern er - Not me, but him" },
                    { german: "doch", en: "however/yet", fa: "ÿ®ÿß ÿß€åŸÜ ÿ≠ÿßŸÑ", example: "Es ist teuer, doch gut - It's expensive, yet good" },
                    { german: "also", en: "so/therefore", fa: "Ÿæÿ≥/ÿ®ŸÜÿßÿ®ÿ±ÿß€åŸÜ", example: "Also gut! - Alright then!" },
                    { german: "sowohl...als auch", en: "both...and", fa: "ŸáŸÖ...ŸáŸÖ", example: "Sowohl Deutsch als auch Englisch - Both German and English" },
                    { german: "entweder...oder", en: "either...or", fa: "€åÿß...€åÿß", example: "Entweder heute oder morgen - Either today or tomorrow" },
                    { german: "weder...noch", en: "neither...nor", fa: "ŸÜŸá...ŸÜŸá", example: "Weder hier noch dort - Neither here nor there" },
                    { german: "nicht nur...sondern auch", en: "not only...but also", fa: "ŸÜŸá ÿ™ŸÜŸáÿß...ÿ®ŸÑ⁄©Ÿá", example: "Nicht nur sch√∂n, sondern auch klug - Not only beautiful but also smart" },
                    { german: "deshalb", en: "therefore", fa: "ÿ®Ÿá ŸáŸÖ€åŸÜ ÿØŸÑ€åŸÑ", example: "Deshalb bin ich hier - That's why I'm here" }
                ]
            },
            complementizers: {
                icon: "üí¨",
                title: { en: "Complementizers", fa: "ÿ≠ÿ±ŸàŸÅ ÿ™⁄©ŸÖ€åŸÑ‚Äå⁄©ŸÜŸÜÿØŸá" },
                description: { en: "Introduce subordinate clauses - verb goes to end!", fa: "ÿ¨ŸÖŸÑÿßÿ™ ŸÅÿ±ÿπ€å ÿ±ÿß ŸÖÿπÿ±ŸÅ€å ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ - ŸÅÿπŸÑ ÿ®Ÿá ÿ¢ÿÆÿ± ŸÖ€å‚Äåÿ±ŸàÿØ!" },
                type: "grid",
                words: [
                    { german: "dass", en: "that", fa: "⁄©Ÿá", example: "Ich wei√ü, dass du kommst - I know that you're coming" },
                    { german: "weil", en: "because", fa: "⁄ÜŸàŸÜ", example: "Ich bleibe, weil ich m√ºde bin - I stay because I'm tired" },
                    { german: "wenn", en: "if/when", fa: "ÿß⁄Øÿ±/ŸàŸÇÿ™€å", example: "Wenn du kommst... - If you come..." },
                    { german: "ob", en: "whether/if", fa: "ÿ¢€åÿß", example: "Ich frage, ob du kommst - I ask if you're coming" },
                    { german: "obwohl", en: "although", fa: "ÿß⁄Øÿ±⁄ÜŸá", example: "Obwohl es regnet... - Although it's raining..." },
                    { german: "bevor", en: "before", fa: "ŸÇÿ®ŸÑ ÿßÿ≤ ÿß€åŸÜ⁄©Ÿá", example: "Bevor du gehst... - Before you go..." },
                    { german: "nachdem", en: "after", fa: "ÿ®ÿπÿØ ÿßÿ≤ ÿß€åŸÜ⁄©Ÿá", example: "Nachdem ich gegessen habe... - After I ate..." },
                    { german: "w√§hrend", en: "while/during", fa: "ÿØÿ± ÿ≠ÿßŸÑ€å ⁄©Ÿá", example: "W√§hrend ich lese... - While I read..." },
                    { german: "bis", en: "until", fa: "ÿ™ÿß", example: "Bis du kommst... - Until you come..." },
                    { german: "damit", en: "so that", fa: "ÿ™ÿß ÿß€åŸÜ⁄©Ÿá", example: "Damit du lernst... - So that you learn..." }
                ]
            },
            adverbs: {
                icon: "‚ö°",
                title: { en: "Common Adverbs", fa: "ŸÇ€åÿØŸáÿß€å Ÿæÿ±⁄©ÿßÿ±ÿ®ÿ±ÿØ" },
                description: { en: "Words that describe how, when, where", fa: "⁄©ŸÑŸÖÿßÿ™€å ⁄©Ÿá ⁄Ü⁄ØŸàŸÜ⁄Ø€åÿå ÿ≤ŸÖÿßŸÜ Ÿà ŸÖ⁄©ÿßŸÜ ÿ±ÿß ÿ™Ÿàÿµ€åŸÅ ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ" },
                type: "grid",
                words: [
                    { german: "sehr", en: "very", fa: "ÿÆ€åŸÑ€å" },
                    { german: "gut", en: "well/good", fa: "ÿÆŸàÿ®" },
                    { german: "schnell", en: "fast/quickly", fa: "ÿ≥ÿ±€åÿπ" },
                    { german: "langsam", en: "slow/slowly", fa: "ÿ¢Ÿáÿ≥ÿ™Ÿá" },
                    { german: "gern(e)", en: "gladly/like to", fa: "ÿ®ÿß ŸÖ€åŸÑ" },
                    { german: "oft", en: "often", fa: "ÿßÿ∫ŸÑÿ®" },
                    { german: "immer", en: "always", fa: "ŸáŸÖ€åÿ¥Ÿá" },
                    { german: "nie", en: "never", fa: "Ÿáÿ±⁄Øÿ≤" },
                    { german: "manchmal", en: "sometimes", fa: "⁄ØÿßŸá€å" },
                    { german: "hier", en: "here", fa: "ÿß€åŸÜÿ¨ÿß" },
                    { german: "dort", en: "there", fa: "ÿ¢ŸÜÿ¨ÿß" },
                    { german: "jetzt", en: "now", fa: "ÿßŸÑÿßŸÜ" },
                    { german: "heute", en: "today", fa: "ÿßŸÖÿ±Ÿàÿ≤" },
                    { german: "morgen", en: "tomorrow", fa: "ŸÅÿ±ÿØÿß" },
                    { german: "gestern", en: "yesterday", fa: "ÿØ€åÿ±Ÿàÿ≤" }
                ]
            },
            numbers: {
                icon: "üî¢",
                title: { en: "Numbers 1-20", fa: "ÿßÿπÿØÿßÿØ €± ÿ™ÿß €≤€∞" },
                description: { en: "Learn to count in German", fa: "ÿ¥ŸÖÿ±ÿØŸÜ ÿ®Ÿá ÿ¢ŸÑŸÖÿßŸÜ€å ÿ±ÿß €åÿßÿØ ÿ®⁄Ø€åÿ±€åÿØ" },
                type: "grid",
                words: [
                    { german: "eins", en: "1", fa: "€±" },
                    { german: "zwei", en: "2", fa: "€≤" },
                    { german: "drei", en: "3", fa: "€≥" },
                    { german: "vier", en: "4", fa: "€¥" },
                    { german: "f√ºnf", en: "5", fa: "€µ" },
                    { german: "sechs", en: "6", fa: "€∂" },
                    { german: "sieben", en: "7", fa: "€∑" },
                    { german: "acht", en: "8", fa: "€∏" },
                    { german: "neun", en: "9", fa: "€π" },
                    { german: "zehn", en: "10", fa: "€±€∞" },
                    { german: "elf", en: "11", fa: "€±€±" },
                    { german: "zw√∂lf", en: "12", fa: "€±€≤" },
                    { german: "dreizehn", en: "13", fa: "€±€≥" },
                    { german: "vierzehn", en: "14", fa: "€±€¥" },
                    { german: "f√ºnfzehn", en: "15", fa: "€±€µ" },
                    { german: "sechzehn", en: "16", fa: "€±€∂" },
                    { german: "siebzehn", en: "17", fa: "€±€∑" },
                    { german: "achtzehn", en: "18", fa: "€±€∏" },
                    { german: "neunzehn", en: "19", fa: "€±€π" },
                    { german: "zwanzig", en: "20", fa: "€≤€∞" }
                ]
            },
            colors: {
                icon: "üé®",
                title: { en: "Colors", fa: "ÿ±ŸÜ⁄Ø‚ÄåŸáÿß" },
                description: { en: "Basic colors in German", fa: "ÿ±ŸÜ⁄Ø‚ÄåŸáÿß€å Ÿæÿß€åŸá ÿ®Ÿá ÿ¢ŸÑŸÖÿßŸÜ€å" },
                type: "grid",
                words: [
                    { german: "rot", en: "red", fa: "ŸÇÿ±ŸÖÿ≤" },
                    { german: "blau", en: "blue", fa: "ÿ¢ÿ®€å" },
                    { german: "gr√ºn", en: "green", fa: "ÿ≥ÿ®ÿ≤" },
                    { german: "gelb", en: "yellow", fa: "ÿ≤ÿ±ÿØ" },
                    { german: "orange", en: "orange", fa: "ŸÜÿßÿ±ŸÜÿ¨€å" },
                    { german: "lila", en: "purple", fa: "ÿ®ŸÜŸÅÿ¥" },
                    { german: "rosa", en: "pink", fa: "ÿµŸàÿ±ÿ™€å" },
                    { german: "schwarz", en: "black", fa: "ÿ≥€åÿßŸá" },
                    { german: "wei√ü", en: "white", fa: "ÿ≥ŸÅ€åÿØ" },
                    { german: "grau", en: "gray", fa: "ÿÆÿß⁄©ÿ≥ÿ™ÿ±€å" },
                    { german: "braun", en: "brown", fa: "ŸÇŸáŸàŸá‚Äåÿß€å" }
                ]
            },
            days: {
                icon: "üìÖ",
                title: { en: "Days of the Week", fa: "ÿ±Ÿàÿ≤Ÿáÿß€å ŸáŸÅÿ™Ÿá" },
                description: { en: "Monday to Sunday", fa: "ÿØŸàÿ¥ŸÜÿ®Ÿá ÿ™ÿß €å⁄©ÿ¥ŸÜÿ®Ÿá" },
                type: "grid",
                words: [
                    { german: "Montag", en: "Monday", fa: "ÿØŸàÿ¥ŸÜÿ®Ÿá" },
                    { german: "Dienstag", en: "Tuesday", fa: "ÿ≥Ÿá‚Äåÿ¥ŸÜÿ®Ÿá" },
                    { german: "Mittwoch", en: "Wednesday", fa: "⁄ÜŸáÿßÿ±ÿ¥ŸÜÿ®Ÿá" },
                    { german: "Donnerstag", en: "Thursday", fa: "ŸæŸÜÿ¨‚Äåÿ¥ŸÜÿ®Ÿá" },
                    { german: "Freitag", en: "Friday", fa: "ÿ¨ŸÖÿπŸá" },
                    { german: "Samstag", en: "Saturday", fa: "ÿ¥ŸÜÿ®Ÿá" },
                    { german: "Sonntag", en: "Sunday", fa: "€å⁄©ÿ¥ŸÜÿ®Ÿá" }
                ]
            },
            months: {
                icon: "üóìÔ∏è",
                title: { en: "Months", fa: "ŸÖÿßŸá‚ÄåŸáÿß" },
                description: { en: "January to December", fa: "⁄òÿßŸÜŸà€åŸá ÿ™ÿß ÿØÿ≥ÿßŸÖÿ®ÿ±" },
                type: "grid",
                words: [
                    { german: "Januar", en: "January", fa: "⁄òÿßŸÜŸà€åŸá" },
                    { german: "Februar", en: "February", fa: "ŸÅŸàÿ±€åŸá" },
                    { german: "M√§rz", en: "March", fa: "ŸÖÿßÿ±ÿ≥" },
                    { german: "April", en: "April", fa: "ÿ¢Ÿàÿ±€åŸÑ" },
                    { german: "Mai", en: "May", fa: "ŸÖŸá" },
                    { german: "Juni", en: "June", fa: "⁄òŸàÿ¶ŸÜ" },
                    { german: "Juli", en: "July", fa: "⁄òŸàÿ¶€åŸá" },
                    { german: "August", en: "August", fa: "ÿßŸàÿ™" },
                    { german: "September", en: "September", fa: "ÿ≥Ÿæÿ™ÿßŸÖÿ®ÿ±" },
                    { german: "Oktober", en: "October", fa: "ÿß⁄©ÿ™ÿ®ÿ±" },
                    { german: "November", en: "November", fa: "ŸÜŸàÿßŸÖÿ®ÿ±" },
                    { german: "Dezember", en: "December", fa: "ÿØÿ≥ÿßŸÖÿ®ÿ±" }
                ]
            },
            greetings: {
                icon: "üëã",
                title: { en: "Greetings & Phrases", fa: "ÿ≥ŸÑÿßŸÖ Ÿà ÿπÿ®ÿßÿ±ÿßÿ™" },
                description: { en: "Common greetings and expressions", fa: "ÿ≥ŸÑÿßŸÖ‚ÄåŸáÿß Ÿà ÿπÿ®ÿßÿ±ÿßÿ™ ÿ±ÿß€åÿ¨" },
                type: "grid",
                words: [
                    { german: "Hallo", en: "Hello", fa: "ÿ≥ŸÑÿßŸÖ" },
                    { german: "Guten Morgen", en: "Good morning", fa: "ÿµÿ®ÿ≠ ÿ®ÿÆ€åÿ±" },
                    { german: "Guten Tag", en: "Good day", fa: "ÿ±Ÿàÿ≤ ÿ®ÿÆ€åÿ±" },
                    { german: "Guten Abend", en: "Good evening", fa: "ÿ¥ÿ® ÿ®ÿÆ€åÿ±" },
                    { german: "Gute Nacht", en: "Good night", fa: "ÿ¥ÿ® ÿ®ÿÆ€åÿ± (ÿÆÿØÿßÿ≠ÿßŸÅÿ∏€å)" },
                    { german: "Auf Wiedersehen", en: "Goodbye", fa: "ÿÆÿØÿßÿ≠ÿßŸÅÿ∏" },
                    { german: "Tsch√ºss", en: "Bye (informal)", fa: "ÿ®ÿß€å" },
                    { german: "Danke", en: "Thank you", fa: "ŸÖŸÖŸÜŸàŸÜ" },
                    { german: "Bitte", en: "Please / You're welcome", fa: "ŸÑÿ∑ŸÅÿßŸã / ÿÆŸàÿßŸáÿ¥ ŸÖ€å‚Äå⁄©ŸÜŸÖ" },
                    { german: "Entschuldigung", en: "Excuse me / Sorry", fa: "ÿ®ÿ®ÿÆÿ¥€åÿØ" },
                    { german: "Ja", en: "Yes", fa: "ÿ®ŸÑŸá" },
                    { german: "Nein", en: "No", fa: "ŸÜŸá" }
                ]
            },
            sein: {
                icon: "üîµ",
                title: { en: "Verb: Sein (To Be)", fa: "ŸÅÿπŸÑ ÿ®ŸàÿØŸÜ" },
                description: { en: "The essential verb 'to be' in all forms", fa: "ŸÅÿπŸÑ ÿ∂ÿ±Ÿàÿ±€å 'ÿ®ŸàÿØŸÜ' ÿØÿ± ÿ™ŸÖÿßŸÖ ÿµŸàÿ±ÿ™‚ÄåŸáÿß" },
                type: "table",
                words: [
                    { german: "sein", en: "to be", fa: "ÿ®ŸàÿØŸÜ", example: "Er liebt es Vater zu sein" },
                    { german: "ich bin", en: "I am", fa: "ŸÖŸÜ Ÿáÿ≥ÿ™ŸÖ", example: "Ich bin Deutschlehrer" },
                    { german: "du bist", en: "you are", fa: "ÿ™Ÿà Ÿáÿ≥ÿ™€å", example: "Du bist eine ruhige Person" },
                    { german: "er ist", en: "he is", fa: "ÿßŸà Ÿáÿ≥ÿ™", example: "Er ist gro√ü" },
                    { german: "sie ist", en: "she is", fa: "ÿßŸà Ÿáÿ≥ÿ™", example: "Sie ist mutig" },
                    { german: "es ist", en: "it is", fa: "ÿ¢ŸÜ Ÿáÿ≥ÿ™", example: "Es ist kalt" },
                    { german: "wir sind", en: "we are", fa: "ŸÖÿß Ÿáÿ≥ÿ™€åŸÖ", example: "Wir sind Br√ºder" },
                    { german: "ihr seid", en: "you are (pl)", fa: "ÿ¥ŸÖÿß Ÿáÿ≥ÿ™€åÿØ", example: "Ihr seid toll" },
                    { german: "sie sind", en: "they are", fa: "ÿ¢ŸÜŸáÿß Ÿáÿ≥ÿ™ŸÜÿØ", example: "Sie sind immer noch verliebt" },
                    { german: "ich war", en: "I was", fa: "ŸÖŸÜ ÿ®ŸàÿØŸÖ", example: "Ich spielte Gitarre als ich jung war" }
                ]
            },
            haben: {
                icon: "üü¢",
                title: { en: "Verb: Haben (To Have)", fa: "ŸÅÿπŸÑ ÿØÿßÿ¥ÿ™ŸÜ" },
                description: { en: "Express possession with 'to have'", fa: "ÿ®€åÿßŸÜ ŸÖÿßŸÑ⁄©€åÿ™ ÿ®ÿß ŸÅÿπŸÑ 'ÿØÿßÿ¥ÿ™ŸÜ'" },
                type: "table",
                words: [
                    { german: "haben", en: "to have", fa: "ÿØÿßÿ¥ÿ™ŸÜ", example: "Sie sind bereit ein neues Haus zu haben" },
                    { german: "ich habe", en: "I have", fa: "ŸÖŸÜ ÿØÿßÿ±ŸÖ", example: "Ich habe eine Menge Arbeit zu tun" },
                    { german: "du hast", en: "you have", fa: "ÿ™Ÿà ÿØÿßÿ±€å", example: "Du hast ein sch√∂nes Schlafzimmer" },
                    { german: "er hat", en: "he has", fa: "ÿßŸà ÿØÿßÿ±ÿØ", example: "Er hat ein neues Auto" },
                    { german: "sie hat", en: "she has", fa: "ÿßŸà ÿØÿßÿ±ÿØ", example: "Sie hat blaue Augen" },
                    { german: "wir haben", en: "we have", fa: "ŸÖÿß ÿØÿßÿ±€åŸÖ", example: "Wir haben Zeit" },
                    { german: "ihr habt", en: "you have (pl)", fa: "ÿ¥ŸÖÿß ÿØÿßÿ±€åÿØ", example: "Ihr habt Gl√ºck" },
                    { german: "sie haben", en: "they have", fa: "ÿ¢ŸÜŸáÿß ÿØÿßÿ±ŸÜÿØ", example: "Sie haben Hunger" },
                    { german: "ich hatte", en: "I had", fa: "ŸÖŸÜ ÿØÿßÿ¥ÿ™ŸÖ", example: "Ich hatte sehr langes Haar" }
                ]
            },
            prepositions: {
                icon: "üìç",
                title: { en: "Prepositions", fa: "ÿ≠ÿ±ŸàŸÅ ÿßÿ∂ÿßŸÅŸá" },
                description: { en: "Words describing relationships in space, time, and logic", fa: "⁄©ŸÑŸÖÿßÿ™€å ⁄©Ÿá ÿ±ÿßÿ®ÿ∑Ÿá ŸÖ⁄©ÿßŸÜÿå ÿ≤ŸÖÿßŸÜ Ÿà ŸÖŸÜÿ∑ŸÇ ÿ±ÿß ÿ™Ÿàÿµ€åŸÅ ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ" },
                type: "grid",
                words: [
                    { german: "f√ºr", en: "for", fa: "ÿ®ÿ±ÿß€å", example: "Das ist f√ºr dich" },
                    { german: "bis", en: "until", fa: "ÿ™ÿß", example: "Ich arbeite bis 8 Uhr" },
                    { german: "in", en: "in", fa: "ÿØÿ±", example: "Ich komme in zwei Stunden zur√ºck" },
                    { german: "aus", en: "from/out of", fa: "ÿßÿ≤", example: "Ich komme aus Berlin" },
                    { german: "mit", en: "with", fa: "ÿ®ÿß", example: "Sie spielen mit einem Hund" },
                    { german: "nach", en: "to/after", fa: "ÿ®Ÿá/ÿ®ÿπÿØ ÿßÿ≤", example: "Ich fahre nach Genf" },
                    { german: "auf", en: "on", fa: "ÿ±Ÿà€å", example: "Der Hund setzt sich auf den Teppich" },
                    { german: "√ºber", en: "over/about", fa: "ÿ®ÿßŸÑÿß€å/ÿØÿ±ÿ®ÿßÿ±Ÿá", example: "Das Flugzeug fliegt √ºber den Berg" },
                    { german: "dann", en: "then", fa: "ÿ≥Ÿæÿ≥", example: "Ich gehe dann mal los" },
                    { german: "vielleicht", en: "maybe", fa: "ÿ¥ÿß€åÿØ", example: "Vielleicht kann ich dein Auto reparieren" },
                    { german: "auch", en: "also/too", fa: "ŸáŸÖ⁄ÜŸÜ€åŸÜ", example: "Er hat auch sehr viel Talent" },
                    { german: "nicht", en: "not", fa: "ŸÜŸá/ŸÜ€åÿ≥ÿ™", example: "Mein Name ist nicht Hendrik" }
                ]
            },
            objectPronouns: {
                icon: "üéØ",
                title: { en: "Object Pronouns & Possessives", fa: "ÿ∂ŸÖÿß€åÿ± ŸÖŸÅÿπŸàŸÑ€å Ÿà ŸÖŸÑ⁄©€å" },
                description: { en: "Identify receivers of actions and show ownership", fa: "⁄Ø€åÿ±ŸÜÿØ⁄ØÿßŸÜ ÿπŸÖŸÑ Ÿà ŸÖÿßŸÑ⁄©€åÿ™ ÿ±ÿß ŸÜÿ¥ÿßŸÜ ŸÖ€å‚ÄåÿØŸáŸÜÿØ" },
                type: "table",
                words: [
                    { german: "mich", en: "me (accusative)", fa: "ŸÖÿ±ÿß", example: "Das Geschenk ist f√ºr mich" },
                    { german: "dich", en: "you (accusative)", fa: "ÿ™Ÿà ÿ±ÿß", example: "Der Brief ist f√ºr dich" },
                    { german: "ihn", en: "him", fa: "ÿßŸà ÿ±ÿß", example: "Ich werde ihn ins Kino mitnehmen" },
                    { german: "uns", en: "us", fa: "ŸÖÿß ÿ±ÿß", example: "Sie sahen uns aus der Ferne" },
                    { german: "mir", en: "me (dative)", fa: "ÿ®Ÿá ŸÖŸÜ", example: "Es ist ein Geschenk von mir" },
                    { german: "sich", en: "oneself/themselves", fa: "ÿÆŸàÿØ", example: "Meine Tochter zieht sich an" },
                    { german: "mein", en: "my (masc/neut)", fa: "ŸÖÿßŸÑ ŸÖŸÜ", example: "Es ist mein Hut" },
                    { german: "meine", en: "my (fem/pl)", fa: "ŸÖÿßŸÑ ŸÖŸÜ", example: "Meine Familie ist toll" },
                    { german: "dein", en: "your (masc/neut)", fa: "ŸÖÿßŸÑ ÿ™Ÿà", example: "Dein Hund ist sehr klug" },
                    { german: "deine", en: "your (fem/pl)", fa: "ŸÖÿßŸÑ ÿ™Ÿà", example: "Deine Schwester ist nett" }
                ]
            },
            modalVerbs: {
                icon: "üí™",
                title: { en: "Modal & Action Verbs", fa: "ÿßŸÅÿπÿßŸÑ ⁄©ŸÖ⁄©€å Ÿà ÿπŸÖŸÑ€å" },
                description: { en: "Express ability, desire, and common activities", fa: "ÿ®€åÿßŸÜ ÿ™ŸàÿßŸÜÿß€å€åÿå ÿÆŸàÿßÿ≥ÿ™Ÿá Ÿà ŸÅÿπÿßŸÑ€åÿ™‚ÄåŸáÿß€å ÿ±ÿß€åÿ¨" },
                type: "grid",
                words: [
                    { german: "wollen", en: "to want", fa: "ÿÆŸàÿßÿ≥ÿ™ŸÜ", example: "Manchmal ist es wichtig etwas anderes machen zu wollen" },
                    { german: "k√∂nnen", en: "can/to be able", fa: "ÿ™ŸàÿßŸÜÿ≥ÿ™ŸÜ", example: "Ich kann zu dir kommen wenn du willst" },
                    { german: "m√ºssen", en: "must/have to", fa: "ÿ®ÿß€åÿØ", example: "Ich muss fr√ºh aufstehen" },
                    { german: "gehen", en: "to go", fa: "ÿ±ŸÅÿ™ŸÜ", example: "Er geht reiten" },
                    { german: "machen", en: "to make/do", fa: "ÿßŸÜÿ¨ÿßŸÖ ÿØÿßÿØŸÜ", example: "Wir wollen einen Kuchen f√ºr Oma machen" },
                    { german: "sagen", en: "to say", fa: "⁄ØŸÅÿ™ŸÜ", example: "Ich will die Wahrheit sagen" },
                    { german: "leben", en: "to live", fa: "ÿ≤ŸÜÿØ⁄Ø€å ⁄©ÿ±ÿØŸÜ", example: "Sie w√ºrden gerne in M√ºnchen leben" },
                    { german: "lieben", en: "to love", fa: "ÿØŸàÿ≥ÿ™ ÿØÿßÿ¥ÿ™ŸÜ", example: "Ich liebe dich" },
                    { german: "kommen", en: "to come", fa: "ÿ¢ŸÖÿØŸÜ", example: "Ich komme morgen" },
                    { german: "sehen", en: "to see", fa: "ÿØ€åÿØŸÜ", example: "Ich sehe dich" }
                ]
            },
            quantifiers: {
                icon: "‚ùì",
                title: { en: "Quantifiers & Questions", fa: "⁄©ŸÖ€åÿ™‚ÄåŸáÿß Ÿà ÿ≥ŸàÿßŸÑÿßÿ™" },
                description: { en: "Ask questions and express quantities", fa: "Ÿæÿ±ÿ≥€åÿØŸÜ ÿ≥ŸàÿßŸÑÿßÿ™ Ÿà ÿ®€åÿßŸÜ ⁄©ŸÖ€åÿ™" },
                type: "grid",
                words: [
                    { german: "wer", en: "who", fa: "⁄ÜŸá ⁄©ÿ≥€å", example: "Wer sind Sie?" },
                    { german: "was", en: "what", fa: "⁄ÜŸá ⁄Ü€åÿ≤€å", example: "Ich wei√ü nicht was ich w√§hlen soll" },
                    { german: "wo", en: "where", fa: "⁄©ÿ¨ÿß", example: "Wo ist das Bahnhof?" },
                    { german: "wann", en: "when", fa: "⁄©€å", example: "Wann kommst du?" },
                    { german: "warum", en: "why", fa: "⁄Üÿ±ÿß", example: "Warum bist du traurig?" },
                    { german: "wie", en: "how", fa: "⁄Ü⁄ØŸàŸÜŸá", example: "Wie geht es dir?" },
                    { german: "alle", en: "all/everyone", fa: "ŸáŸÖŸá", example: "Alle lieben den Sommer" },
                    { german: "etwas", en: "something", fa: "⁄Ü€åÿ≤€å", example: "Es ist etwas Schweres in diesem Karton" },
                    { german: "nichts", en: "nothing", fa: "Ÿá€å⁄Ü ⁄Ü€åÿ≤", example: "Es gibt nichts im Raum" },
                    { german: "alles", en: "everything", fa: "ŸáŸÖŸá ⁄Ü€åÿ≤", example: "Alles was wir besitzen ist in diesen Kartons" }
                ]
            }
        };

        // =====================
        // STATE
        // =====================
        let currentLang = 'en';
        let voiceSpeed = 1.0;
        let currentCategory = null;

        // =====================
        // INITIALIZATION
        // =====================
        document.addEventListener('DOMContentLoaded', () => {
            loadPreferences();
            loadCategory();
            setupControls();
        });

        function loadPreferences() {
            const savedLang = window.MisiroData ? MisiroData.getLanguage() : localStorage.getItem('misiro_language');
            if (savedLang) {
                currentLang = savedLang;
            } else {
                const browserLang = navigator.language || navigator.userLanguage || 'en';
                currentLang = browserLang.startsWith('fa') ? 'fa' : 'en';
            }

            const savedSpeed = window.MisiroData ? MisiroData.getVoiceSpeed() : localStorage.getItem('misiro_voice_speed');
            if (savedSpeed !== null) {
                voiceSpeed = typeof savedSpeed === 'number' ? savedSpeed : parseFloat(savedSpeed);
            }
        }

        function loadCategory() {
            // Get category from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const cat = urlParams.get('cat') || 'pronouns';

            currentCategory = categoryData[cat];
            if (!currentCategory) {
                currentCategory = categoryData.pronouns;
            }

            renderCategory();
        }

        function setupControls() {
            const langSelect = document.getElementById('language-select');
            const speedSelect = document.getElementById('speed-select');

            langSelect.value = currentLang;
            speedSelect.value = voiceSpeed.toString();

            langSelect.addEventListener('change', (e) => {
                currentLang = e.target.value;
                if (window.MisiroData) MisiroData.setLanguage(currentLang);
                else localStorage.setItem('misiro_language', currentLang);
                renderCategory();
            });

            speedSelect.addEventListener('change', (e) => {
                voiceSpeed = parseFloat(e.target.value);
                if (window.MisiroData) MisiroData.setVoiceSpeed(voiceSpeed);
                else localStorage.setItem('misiro_voice_speed', voiceSpeed.toString());
            });
        }

        // =====================
        // RENDERING
        // =====================
        function renderCategory() {
            const cat = currentCategory;
            const title = cat.title[currentLang] || cat.title.en;
            const desc = cat.description[currentLang] || cat.description.en;

            // Update header
            document.getElementById('cat-icon').textContent = cat.icon;
            document.getElementById('cat-title').textContent = title;
            document.getElementById('cat-description').textContent = desc;
            document.getElementById('page-title').textContent = `${title} - Misiro`;
            document.getElementById('back-text').textContent = currentLang === 'fa' ? 'ÿ®ÿßÿ≤⁄Øÿ¥ÿ™' : 'Back';

            // Render content
            const container = document.getElementById('content-container');
            if (cat.type === 'table') {
                container.innerHTML = renderPronounTable(cat.words);
            } else {
                container.innerHTML = renderWordGrid(cat.words);
            }
        }

        function renderWordGrid(words) {
            const items = words.map((word, index) => {
                const translation = currentLang === 'fa' ? word.fa : word.en;
                const escapedGerman = word.german.replace(/'/g, "\\'");
                const escapedExample = word.example ? word.example.replace(/'/g, "\\'") : '';
                const exampleHtml = word.example ? `
                    <div class="word-example" onclick="event.stopPropagation(); playExample('${escapedExample}')">
                        ${word.example} <span class="example-speaker">üîä</span>
                    </div>` : '';
                return `
                    <div class="word-card" onclick="playWord('${escapedGerman}')">
                        <div class="word-german">${word.german}</div>
                        <div class="word-translation">${translation}</div>
                        ${exampleHtml}
                    </div>
                `;
            }).join('');

            return `<div class="word-grid">${items}</div>`;
        }

        function renderPronounTable(words) {
            const rows = words.map(word => {
                const meaning = currentLang === 'fa' ? word.fa : word.en;
                const escapedGerman = word.german.replace(/'/g, "\\'");
                const escapedExample = word.example ? word.example.replace(/'/g, "\\'") : '';
                return `
                    <div class="pronoun-row" onclick="playWord('${escapedGerman}')">
                        <div class="pronoun-german">${word.german}</div>
                        <div class="pronoun-meaning">${meaning}</div>
                        <div class="pronoun-example" onclick="event.stopPropagation(); playExample('${escapedExample}')">${word.example} üîä</div>
                    </div>
                `;
            }).join('');

            return `<div class="pronoun-grid">${rows}</div>`;
        }

        // =====================
        // AUDIO
        // =====================
        function playWord(text) {
            window.speechSynthesis.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'de-DE';
            utterance.rate = voiceSpeed;

            window.speechSynthesis.speak(utterance);
        }

        function playExample(text) {
            if (!text) return;
            window.speechSynthesis.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'de-DE';
            utterance.rate = voiceSpeed;

            window.speechSynthesis.speak(utterance);
        }

        function playWordAndExample(word, example) {
            window.speechSynthesis.cancel();

            // Play word first
            const wordUtterance = new SpeechSynthesisUtterance(word);
            wordUtterance.lang = 'de-DE';
            wordUtterance.rate = voiceSpeed;

            // When word finishes, play example after a short pause
            wordUtterance.onend = () => {
                if (example) {
                    setTimeout(() => {
                        const exampleUtterance = new SpeechSynthesisUtterance(example);
                        exampleUtterance.lang = 'de-DE';
                        exampleUtterance.rate = voiceSpeed;
                        window.speechSynthesis.speak(exampleUtterance);
                    }, 300);
                }
            };

            window.speechSynthesis.speak(wordUtterance);
        }

        window.playWord = playWord;
        window.playExample = playExample;
        window.playWordAndExample = playWordAndExample;
    </script>
</body>

</html>